<!DOCTYPE html>
<html ng-app="awkwardAssist" ng-controller="MainCtrl as main">
<head lang="en">
    <meta charset="UTF-8">
    <title>Awkward Assist</title>

<!--    Firebase database and config-->
    <script src="https://www.gstatic.com/firebasejs/3.3.0/firebase.js"></script>
    <script>
        var config = {
            apiKey: "AIzaSyBgjDHluQhaDVw727m2cPpbGGi14NzsAtY",
            authDomain: "crackling-inferno-7707.firebaseapp.com",
            databaseURL: "https://crackling-inferno-7707.firebaseio.com"
        }
        firebase.initializeApp(config);
        var rootRef = firebase.database().ref();
    </script>
    
<!--    Dependencies-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
    <script src="https://cdn.firebase.com/libs/angularfire/2.0.2/angularfire.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.13/angular-ui-router.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/1.3.2/ui-bootstrap-tpls.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-cookies.js"></script>
    
<!--    Stylesheets and style dependencies-->
    <link rel="stylesheet" type="text/css" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" type="text/css" href="/styles/normalize.css">
    <link rel="stylesheet" type="text/css" href="/styles/main.css">
    <link rel="stylesheet" type="text/css" href="/styles/modal.css">
    <link rel="stylesheet" type='text/css' href="/styles/chatSidebar.css">
    <link rel="stylesheet" type="text/css" href="/styles/textArea.css">
    <link rel="stylesheet" type="text/css" href="/styles/newRoomModal.css">
    <link rel="stylesheet" type="text/css" href="/styles/setCurrentUserModal.css">
    <link rel="stylesheet" type="text/css" href="/styles/chatRoom.css">
    <link rel="stylesheet" type="text/css" href="/styles/insertable.css">
    
<!--    Root module with configuration and run file-->
    <script src="/scripts/app.js"></script>
    <script src="/scripts/run.js"></script>
    
<!--    Controllers-->
    <script src="/scripts/controllers/MainCtrl.js"></script>
    <script src="/scripts/controllers/ChatSidebarCtrl.js"></script>
    <script src="/scripts/controllers/ChatroomCtrl.js"></script>
    <script src="/scripts/controllers/NewRoomModalCtrl.js"></script>
    <script src="/scripts/controllers/SetCurrentUserModalCtrl.js"></script>
    <script src="/scripts/controllers/InsertableCtrl.js"></script>
    
<!--    Services-->
    <script src="/scripts/services/room.js"></script>
    <script src="/scripts/services/message.js"></script>
    <script src="/scripts/services/insertable.js"></script>
    <script src="/scripts/services/fixtures.js"></script>
    
<!--    Filters-->
    <script src="/scripts/filters/sentAt.js"></script>
    
<!--    Templates-->
    <script src="/templates/setCurrentUserModal.html"></script>
</head>
<body>
    
    <aside class="chatroom-sidebar" ng-controller="ChatSidebarCtrl as chatSidebar">
        <header class="chatroom-sidebar-header">Awkward Assist</header>
        <button class="new-chatroom-button" ng-click="chatSidebar.openNewRoomModal()">New room</button>
        <ul class="chatroom-list">
            <li class="chatroom-list-item" ng-repeat="room in chatSidebar.rooms" ng-click="chatSidebar.selectActiveRoom(room)">{{ room.name }}</li>
        </ul>
    </aside>
    
    <section ng-controller="ChatroomCtrl as chatroom">
        <header class="chatroom-header">
            <div id="header-room-container">
                <h4 id="header-room-text" ng-show="chatroom.activeRoom">Room: {{ chatroom.activeRoom.name }}</h4>
            </div>
            <div id="header-username-container">
                <h4 id="header-username-text">
                    User: {{ username }}
                    <br />
                    <a id="header-change-username" ng-click="chatroom.openSetCurrentUserModal()">Change Username</a>
                </h4>
            </div>
        </header>
        <section class="chatroom-messages-container">
            <div class="chatroom-message" ng-repeat="message in chatroom.activeRoomMessages" ng-class="{even: $even, odd: $odd, own: message.username === chatroom.activeUsername}">
                <span class="message-top-line" ng-class="{own: message.username === chatroom.activeUsername}">
                    <span class="username">{{ message.username }}</span>
                    <span class="sent-at" ng-class="{own: message.username === chatroom.activeUsername}">{{ message.sentAt | SentAt }}</span>
                </span>
                <span class="message-content" ng-class="{own: message.username === chatroom.activeUsername}">{{ message.content }}</span>
            </div>
        </section>
        <footer>
            <form id="footer-new-message" ng-submit="chatroom.addMessage(chatroom.newMessageContent)">
                <textarea id="footer-text-input" placeholder="Enter message here..." ng-model="chatroom.newMessageContent" form="footer-new-message"></textarea>
                <input id="footer-submit" type="submit" value="Enter">
            </form>
            <div class="insertable-container" ng-controller="InsertableCtrl as insertable">
                <button class="insertable-button">
                    <span class="ion-help-buoy"></span>
                </button>
                <menu class="insertable-menu">
                    <button class="smack-talk" ng-click="insertable.smackTalk()">Talk some smack!</button>
                </menu>
            </div>
        </footer>
    </section>
    
    <script src="/scripts/magic/insertableMenu.js"></script>
</body>
</html>